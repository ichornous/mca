namespace :db do
  desc 'Add admin account'
  task :create_admin, [:password] => [:environment] do |t, args|
    password = args.password
    if password.nil?
      password = [*('A'..'Z')].sample(8).join
      puts "Autogenerated password is #{password}"
    end

    admin = User.create!(first_name: 'Igor',
                         last_name: 'Chornous',
                         email: 'igor@chornous.com',
                         password: password,
                         password_confirmation: password)
    admin.confirmed_at = DateTime.now
    admin.admin!
    admin.save
  end
end